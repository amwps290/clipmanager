# Windows 使用指南

本指南专门针对 Windows 用户，解释 ClipManager 在 Windows 上的不同版本和使用方法。

## 🪟 Windows 版本说明

ClipManager 为 Windows 用户提供了多个版本，以满足不同的使用需求：

### 1. 标准发布版本 (`clipmanager-windows.exe`)
- **特点**: 无控制台窗口，提供最佳用户体验
- **适用**: 普通用户日常使用
- **优点**: 界面简洁，不会显示命令行窗口
- **缺点**: 如果程序出错，用户可能看不到错误信息

### 2. 控制台调试版本 (`clipmanager-windows-console.exe`)
- **特点**: 显示控制台窗口，可以看到程序输出
- **适用**: 遇到问题时的故障排除
- **优点**: 可以看到详细的错误信息和日志
- **缺点**: 会显示额外的命令行窗口

## 🚀 推荐使用流程

### 首次使用
1. **下载标准版本** (`clipmanager-windows.exe`)
2. **双击运行**，如果程序正常启动，继续使用
3. **如果程序无响应或无法启动**，下载控制台版本进行诊断

### 遇到问题时
1. **使用控制台版本** (`clipmanager-windows-console.exe`)
2. **查看控制台输出**，寻找错误信息
3. **检查日志文件** (位置见下文)
4. **将错误信息反馈给开发者**

## 📁 文件位置

### 日志文件
- **位置**: `%TEMP%\clipmanager\clipmanager.log`
- **内容**: 程序运行日志，包含启动信息和错误记录
- **查看方法**: 
  ```
  Windows + R → 输入 %TEMP%\clipmanager → 回车
  ```

### 错误报告文件
- **位置**: `%TEMP%\clipmanager_error.txt`
- **内容**: 程序崩溃时的错误信息
- **用途**: 发送给开发者进行问题诊断

### 配置文件
- **位置**: `%APPDATA%\clipmanager\config.toml`
- **内容**: 应用程序设置和偏好

### 数据库文件
- **位置**: `%APPDATA%\clipmanager\clipboard.db`
- **内容**: 剪切板历史记录

## 🔧 常见问题解决

### 问题 1: 双击程序无反应
**症状**: 双击 `clipmanager-windows.exe` 后没有任何反应

**解决步骤**:
1. 下载并运行 `clipmanager-windows-console.exe`
2. 查看控制台输出的错误信息
3. 常见原因：
   - 缺少必要的系统库
   - 权限不足
   - 配置文件损坏

### 问题 2: 程序启动后立即关闭
**症状**: 程序窗口闪现后立即消失

**解决步骤**:
1. 使用控制台版本查看错误信息
2. 检查日志文件 `%TEMP%\clipmanager\clipmanager.log`
3. 常见原因：
   - 数据库文件损坏
   - 配置文件格式错误
   - 系统兼容性问题

### 问题 3: 界面显示异常
**症状**: 程序界面显示不正常，如字体缺失、布局错乱

**解决步骤**:
1. 检查系统字体设置
2. 尝试删除配置文件让程序重新初始化
3. 确保系统支持 OpenGL

### 问题 4: 剪切板监控不工作
**症状**: 程序运行正常，但不能检测到剪切板变化

**解决步骤**:
1. 检查程序是否有足够的权限
2. 确认没有其他剪切板管理软件冲突
3. 重启程序或系统

## 🛠️ 高级故障排除

### 启用详细日志
1. 创建环境变量 `RUST_LOG=debug`
2. 运行控制台版本
3. 查看详细的调试信息

### 重置程序设置
1. 关闭 ClipManager
2. 删除配置目录：`%APPDATA%\clipmanager`
3. 重新启动程序

### 检查系统兼容性
- **最低要求**: Windows 10
- **推荐**: Windows 10 1903 或更高版本
- **架构**: x64 (64位)

## 📞 获取帮助

### 报告问题时请提供
1. **Windows 版本**: 如 "Windows 10 21H2"
2. **程序版本**: 如 "ClipManager v0.1.0"
3. **错误信息**: 控制台输出或日志文件内容
4. **重现步骤**: 如何触发问题

### 联系方式
- **GitHub Issues**: [项目 Issues 页面]
- **日志文件**: 请附上 `clipmanager.log` 文件
- **错误报告**: 请附上 `clipmanager_error.txt` 文件

## 💡 使用技巧

### 性能优化
- 定期清理剪切板历史记录
- 避免复制过大的内容
- 关闭不必要的其他剪切板软件

### 安全建议
- 不要在剪切板中保存敏感信息
- 定期清理剪切板历史
- 注意程序的网络权限设置

### 自定义设置
- 修改 `config.toml` 文件自定义行为
- 调整历史记录保存数量
- 设置自动清理策略

---

**提示**: 如果标准版本工作正常，建议使用标准版本以获得最佳用户体验。只有在遇到问题时才使用控制台版本进行诊断。
